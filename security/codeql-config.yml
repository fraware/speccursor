name: 'SpecCursor Security Analysis'

# Disable default queries and use custom query pack
disable-default-queries: true

# Use the security-extended and security-and-quality query suites
queries:
  - uses: security-extended
  - uses: security-and-quality
  - uses: ./security/custom-queries

# Paths to include in analysis
paths:
  - apps/
  - packages/
  - workers/
  - scripts/

# Paths to exclude from analysis
paths-ignore:
  - node_modules/
  - dist/
  - build/
  - .git/
  - tests/
  - docs/

# Query filters for custom security rules
query-filters:
  - include:
      tags contain: security
  - include:
      tags contain: external
  - include:
      tags contain: injection
  - include:
      tags contain: deserialization
  - include:
      tags contain: ssrf
  - include:
      tags contain: xss
  - include:
      tags contain: sql-injection
  - include:
      tags contain: path-traversal
  - include:
      tags contain: command-injection
  - include:
      tags contain: crypto
  - include:
      tags contain: authentication
  - include:
      tags contain: authorization

# Analysis settings
analysis:
  # Run queries in parallel
  threads: 4

  # Memory limit for analysis
  memory: 8192

  # Timeout for individual queries
  query-timeout: 300

  # Enable inter-procedural analysis
  inter-procedural: true

  # Enable cross-file analysis
  cross-file: true

# Custom query pack configuration
query-packs:
  - name: custom-security-rules
    path: ./security/custom-queries
    queries:
      - name: ssrf-detection
        description: 'Detect Server-Side Request Forgery vulnerabilities'
        severity: error
        precision: high
      - name: insecure-deserialization
        description: 'Detect insecure deserialization patterns'
        severity: error
        precision: high
      - name: sql-injection
        description: 'Detect SQL injection vulnerabilities'
        severity: error
        precision: high
      - name: command-injection
        description: 'Detect command injection vulnerabilities'
        severity: error
        precision: high
      - name: path-traversal
        description: 'Detect path traversal vulnerabilities'
        severity: error
        precision: high
      - name: xss-detection
        description: 'Detect Cross-Site Scripting vulnerabilities'
        severity: error
        precision: high
      - name: crypto-weak-algorithms
        description: 'Detect use of weak cryptographic algorithms'
        severity: warning
        precision: medium
      - name: hardcoded-secrets
        description: 'Detect hardcoded secrets and credentials'
        severity: error
        precision: high
      - name: insecure-random
        description: 'Detect use of insecure random number generators'
        severity: warning
        precision: medium
      - name: missing-authentication
        description: 'Detect missing authentication checks'
        severity: error
        precision: high
      - name: missing-authorization
        description: 'Detect missing authorization checks'
        severity: error
        precision: high
      - name: unsafe-external-input
        description: 'Detect unsafe handling of external input'
        severity: error
        precision: high
      - name: prototype-pollution
        description: 'Detect prototype pollution vulnerabilities'
        severity: error
        precision: high
      - name: unsafe-eval
        description: 'Detect use of eval() and similar dangerous functions'
        severity: error
        precision: high
      - name: unsafe-regex
        description: 'Detect potentially unsafe regular expressions'
        severity: warning
        precision: medium
      - name: buffer-overflow
        description: 'Detect potential buffer overflow vulnerabilities'
        severity: error
        precision: high
      - name: race-condition
        description: 'Detect potential race conditions'
        severity: warning
        precision: medium
      - name: memory-leak
        description: 'Detect potential memory leaks'
        severity: warning
        precision: medium
      - name: null-pointer-dereference
        description: 'Detect potential null pointer dereferences'
        severity: error
        precision: high
      - name: use-after-free
        description: 'Detect use-after-free vulnerabilities'
        severity: error
        precision: high
      - name: integer-overflow
        description: 'Detect potential integer overflow vulnerabilities'
        severity: warning
        precision: medium
      - name: format-string
        description: 'Detect format string vulnerabilities'
        severity: error
        precision: high
      - name: double-free
        description: 'Detect double-free vulnerabilities'
        severity: error
        precision: high
      - name: stack-overflow
        description: 'Detect potential stack overflow vulnerabilities'
        severity: error
        precision: high
      - name: heap-overflow
        description: 'Detect potential heap overflow vulnerabilities'
        severity: error
        precision: high
      - name: type-confusion
        description: 'Detect type confusion vulnerabilities'
        severity: error
        precision: high
      - name: logic-bomb
        description: 'Detect potential logic bombs'
        severity: warning
        precision: low
      - name: backdoor
        description: 'Detect potential backdoors'
        severity: error
        precision: low
      - name: easter-egg
        description: 'Detect potential easter eggs'
        severity: warning
        precision: low
      - name: dead-code
        description: 'Detect dead code'
        severity: note
        precision: low
      - name: unreachable-code
        description: 'Detect unreachable code'
        severity: note
        precision: low
      - name: duplicate-code
        description: 'Detect duplicate code'
        severity: note
        precision: low
      - name: complex-code
        description: 'Detect overly complex code'
        severity: note
        precision: low
      - name: long-functions
        description: 'Detect functions that are too long'
        severity: note
        precision: low
      - name: deep-nesting
        description: 'Detect deeply nested code'
        severity: note
        precision: low
      - name: magic-numbers
        description: 'Detect magic numbers'
        severity: note
        precision: low
      - name: commented-code
        description: 'Detect commented-out code'
        severity: note
        precision: low
      - name: todo-comments
        description: 'Detect TODO comments'
        severity: note
        precision: low
      - name: fixme-comments
        description: 'Detect FIXME comments'
        severity: note
        precision: low
      - name: hack-comments
        description: 'Detect HACK comments'
        severity: note
        precision: low
      - name: xxx-comments
        description: 'Detect XXX comments'
        severity: note
        precision: low

# Output configuration
output:
  # Output format
  format: sarif-latest

  # Output file
  output-file: codeql-results.sarif

  # Include query metadata
  include-metadata: true

  # Include query help
  include-help: true

  # Include query source
  include-source: true

  # Include query tags
  include-tags: true

  # Include query severity
  include-severity: true

  # Include query precision
  include-precision: true

  # Include query kind
  include-kind: true

  # Include query id
  include-id: true

  # Include query name
  include-name: true

  # Include query description
  include-description: true

  # Include query message
  include-message: true

  # Include query locations
  include-locations: true

  # Include query paths
  include-paths: true

  # Include query ranges
  include-ranges: true

  # Include query snippets
  include-snippets: true

  # Include query contexts
  include-contexts: true

  # Include query traces
  include-traces: true

  # Include query flows
  include-flows: true

  # Include query graphs
  include-graphs: true

  # Include query edges
  include-edges: true

  # Include query nodes
  include-nodes: true

  # Include query properties
  include-properties: true

  # Include query annotations
  include-annotations: true

  # Include query fixes
  include-fixes: true

  # Include query rule-help
  include-rule-help: true

  # Include query rule-help-uri
  include-rule-help-uri: true

  # Include query rule-id
  include-rule-id: true

  # Include query rule-name
  include-rule-name: true

  # Include query rule-short-description
  include-rule-short-description: true

  # Include query rule-full-description
  include-rule-full-description: true

  # Include query rule-category
  include-rule-category: true

  # Include query rule-precision
  include-rule-precision: true

  # Include query rule-severity
  include-rule-severity: true

  # Include query rule-tags
  include-rule-tags: true

  # Include query rule-examples
  include-rule-examples: true

  # Include query rule-non-examples
  include-rule-non-examples: true

  # Include query rule-notes
  include-rule-notes: true

  # Include query rule-references
  include-rule-references: true

  # Include query rule-version
  include-rule-version: true

  # Include query rule-author
  include-rule-author: true

  # Include query rule-date
  include-rule-date: true

  # Include query rule-license
  include-rule-license: true

  # Include query rule-copyright
  include-rule-copyright: true

  # Include query rule-disclaimer
  include-rule-disclaimer: true

  # Include query rule-acknowledgments
  include-rule-acknowledgments: true

  # Include query rule-contributors
  include-rule-contributors: true

  # Include query rule-maintainers
  include-rule-maintainers: true

  # Include query rule-support
  include-rule-support: true

  # Include query rule-bugs
  include-rule-bugs: true

  # Include query rule-feature-requests
  include-rule-feature-requests: true

  # Include query rule-discussions
  include-rule-discussions: true

  # Include query rule-wiki
  include-rule-wiki: true

  # Include query rule-blog
  include-rule-blog: true

  # Include query rule-video
  include-rule-video: true

  # Include query rule-podcast
  include-rule-podcast: true

  # Include query rule-webinar
  include-rule-webinar: true

  # Include query rule-conference
  include-rule-conference: true

  # Include query rule-workshop
  include-rule-workshop: true

  # Include query rule-training
  include-rule-training: true

  # Include query rule-certification
  include-rule-certification: true

  # Include query rule-accreditation
  include-rule-accreditation: true

  # Include query rule-endorsement
  include-rule-endorsement: true

  # Include query rule-recommendation
  include-rule-recommendation: true

  # Include query rule-approval
  include-rule-approval: true

  # Include query rule-validation
  include-rule-validation: true

  # Include query rule-verification
  include-rule-verification: true

  # Include query rule-testing
  include-rule-testing: true

  # Include query rule-debugging
  include-rule-debugging: true

  # Include query rule-profiling
  include-rule-profiling: true

  # Include query rule-optimization
  include-rule-optimization: true

  # Include query rule-refactoring
  include-rule-refactoring: true

  # Include query rule-restructuring
  include-rule-restructuring: true

  # Include query rule-reengineering
  include-rule-reengineering: true

  # Include query rule-modernization
  include-rule-modernization: true

  # Include query rule-migration
  include-rule-migration: true

  # Include query rule-upgrade
  include-rule-upgrade: true

  # Include query rule-update
  include-rule-update: true

  # Include query rule-patch
  include-rule-patch: true

  # Include query rule-fix
  include-rule-fix: true

  # Include query rule-workaround
  include-rule-workaround: true

  # Include query rule-solution
  include-rule-solution: true

  # Include query rule-resolution
  include-rule-resolution: true

  # Include query rule-answer
  include-rule-answer: true

  # Include query rule-explanation
  include-rule-explanation: true

  # Include query rule-clarification
  include-rule-clarification: true

  # Include query rule-elucidation
  include-rule-elucidation: true

  # Include query rule-illumination
  include-rule-illumination: true

  # Include query rule-enlightenment
  include-rule-enlightenment: true

  # Include query rule-edification
  include-rule-edification: true

  # Include query rule-instruction
  include-rule-instruction: true

  # Include query rule-guidance
  include-rule-guidance: true

  # Include query rule-direction
  include-rule-direction: true

  # Include query rule-leadership
  include-rule-leadership: true

  # Include query rule-management
  include-rule-management: true

  # Include query rule-administration
  include-rule-administration: true

  # Include query rule-supervision
  include-rule-supervision: true

  # Include query rule-oversight
  include-rule-oversight: true

  # Include query rule-control
  include-rule-control: true

  # Include query rule-regulation
  include-rule-regulation: true

  # Include query rule-governance
  include-rule-governance: true

  # Include query rule-policy
  include-rule-policy: true

  # Include query rule-procedure
  include-rule-procedure: true

  # Include query rule-protocol
  include-rule-protocol: true

  # Include query rule-standard
  include-rule-standard: true

  # Include query rule-specification
  include-rule-specification: true

  # Include query rule-requirement
  include-rule-requirement: true

  # Include query rule-criterion
  include-rule-criterion: true

  # Include query rule-benchmark
  include-rule-benchmark: true

  # Include query rule-metric
  include-rule-metric: true

  # Include query rule-indicator
  include-rule-indicator: true

  # Include query rule-measure
  include-rule-measure: true

  # Include query rule-gauge
  include-rule-gauge: true

  # Include query rule-barometer
  include-rule-barometer: true

  # Include query rule-thermometer
  include-rule-thermometer: true

  # Include query rule-odometer
  include-rule-odometer: true

  # Include query rule-speedometer
  include-rule-speedometer: true

  # Include query rule-tachometer
  include-rule-tachometer: true

  # Include query rule-voltmeter
  include-rule-voltmeter: true

  # Include query rule-ammeter
  include-rule-ammeter: true

  # Include query rule-ohmmeter
  include-rule-ohmmeter: true

  # Include query rule-multimeter
  include-rule-multimeter: true

  # Include query rule-oscilloscope
  include-rule-oscilloscope: true

  # Include query rule-spectrum-analyzer
  include-rule-spectrum-analyzer: true

  # Include query rule-network-analyzer
  include-rule-network-analyzer: true

  # Include query rule-logic-analyzer
  include-rule-logic-analyzer: true

  # Include query rule-protocol-analyzer
  include-rule-protocol-analyzer: true

  # Include query rule-packet-analyzer
  include-rule-packet-analyzer: true

  # Include query rule-traffic-analyzer
  include-rule-traffic-analyzer: true

  # Include query rule-performance-analyzer
  include-rule-performance-analyzer: true

  # Include query rule-security-analyzer
  include-rule-security-analyzer: true

  # Include query rule-vulnerability-analyzer
  include-rule-vulnerability-analyzer: true

  # Include query rule-threat-analyzer
  include-rule-threat-analyzer: true

  # Include query rule-risk-analyzer
  include-rule-risk-analyzer: true

  # Include query rule-compliance-analyzer
  include-rule-compliance-analyzer: true

  # Include query rule-audit-analyzer
  include-rule-audit-analyzer: true

  # Include query rule-forensic-analyzer
  include-rule-forensic-analyzer: true

  # Include query rule-malware-analyzer
  include-rule-malware-analyzer: true

  # Include query rule-virus-analyzer
  include-rule-virus-analyzer: true

  # Include query rule-trojan-analyzer
  include-rule-trojan-analyzer: true

  # Include query rule-worm-analyzer
  include-rule-worm-analyzer: true

  # Include query rule-spyware-analyzer
  include-rule-spyware-analyzer: true

  # Include query rule-adware-analyzer
  include-rule-adware-analyzer: true

  # Include query rule-ransomware-analyzer
  include-rule-ransomware-analyzer: true

  # Include query rule-cryptojacking-analyzer
  include-rule-cryptojacking-analyzer: true

  # Include query rule-keylogger-analyzer
  include-rule-keylogger-analyzer: true

  # Include query rule-backdoor-analyzer
  include-rule-backdoor-analyzer: true

  # Include query rule-rootkit-analyzer
  include-rule-rootkit-analyzer: true

  # Include query rule-bootkit-analyzer
  include-rule-bootkit-analyzer: true

  # Include query rule-firmware-analyzer
  include-rule-firmware-analyzer: true

  # Include query rule-bios-analyzer
  include-rule-bios-analyzer: true

  # Include query rule-uefi-analyzer
  include-rule-uefi-analyzer: true

  # Include query rule-secure-boot-analyzer
  include-rule-secure-boot-analyzer: true

  # Include query rule-tpm-analyzer
  include-rule-tpm-analyzer: true

  # Include query rule-hsm-analyzer
  include-rule-hsm-analyzer: true

  # Include query rule-pki-analyzer
  include-rule-pki-analyzer: true

  # Include query rule-certificate-analyzer
  include-rule-certificate-analyzer: true

  # Include query rule-key-analyzer
  include-rule-key-analyzer: true

  # Include query rule-token-analyzer
  include-rule-token-analyzer: true

  # Include query rule-credential-analyzer
  include-rule-credential-analyzer: true

  # Include query rule-password-analyzer
  include-rule-password-analyzer: true

  # Include query rule-hash-analyzer
  include-rule-hash-analyzer: true

  # Include query rule-salt-analyzer
  include-rule-salt-analyzer: true

  # Include query rule-iv-analyzer
  include-rule-iv-analyzer: true

  # Include query rule-nonce-analyzer
  include-rule-nonce-analyzer: true

  # Include query rule-entropy-analyzer
  include-rule-entropy-analyzer: true

  # Include query rule-randomness-analyzer
  include-rule-randomness-analyzer: true

  # Include query rule-pseudorandomness-analyzer
  include-rule-pseudorandomness-analyzer: true

  # Include query rule-cryptographic-analyzer
  include-rule-cryptographic-analyzer: true

  # Include query rule-encryption-analyzer
  include-rule-encryption-analyzer: true

  # Include query rule-decryption-analyzer
  include-rule-decryption-analyzer: true

  # Include query rule-signing-analyzer
  include-rule-signing-analyzer: true

  # Include query rule-verification-analyzer
  include-rule-verification-analyzer: true

  # Include query rule-authentication-analyzer
  include-rule-authentication-analyzer: true

  # Include query rule-authorization-analyzer
  include-rule-authorization-analyzer: true

  # Include query rule-identification-analyzer
  include-rule-identification-analyzer: true

  # Include query rule-validation-analyzer
  include-rule-validation-analyzer: true

  # Include query rule-sanitization-analyzer
  include-rule-sanitization-analyzer: true

  # Include query rule-filtering-analyzer
  include-rule-filtering-analyzer: true

  # Include query rule-escaping-analyzer
  include-rule-escaping-analyzer: true

  # Include query rule-encoding-analyzer
  include-rule-encoding-analyzer: true

  # Include query rule-decoding-analyzer
  include-rule-decoding-analyzer: true

  # Include query rule-compression-analyzer
  include-rule-compression-analyzer: true

  # Include query rule-decompression-analyzer
  include-rule-decompression-analyzer: true

  # Include query rule-serialization-analyzer
  include-rule-serialization-analyzer: true

  # Include query rule-deserialization-analyzer
  include-rule-deserialization-analyzer: true

  # Include query rule-marshaling-analyzer
  include-rule-marshaling-analyzer: true

  # Include query rule-unmarshaling-analyzer
  include-rule-unmarshaling-analyzer: true

  # Include query rule-parsing-analyzer
  include-rule-parsing-analyzer: true

  # Include query rule-formatting-analyzer
  include-rule-formatting-analyzer: true

  # Include query rule-templating-analyzer
  include-rule-templating-analyzer: true

  # Include query rule-rendering-analyzer
  include-rule-rendering-analyzer: true

  # Include query rule-interpolation-analyzer
  include-rule-interpolation-analyzer: true

  # Include query rule-substitution-analyzer
  include-rule-substitution-analyzer: true

  # Include query rule-replacement-analyzer
  include-rule-replacement-analyzer: true

  # Include query rule-transformation-analyzer
  include-rule-transformation-analyzer: true

  # Include query rule-conversion-analyzer
  include-rule-conversion-analyzer: true

  # Include query rule-translation-analyzer
  include-rule-translation-analyzer: true

  # Include query rule-localization-analyzer
  include-rule-localization-analyzer: true

  # Include query rule-internationalization-analyzer
  include-rule-internationalization-analyzer: true

  # Include query rule-globalization-analyzer
  include-rule-globalization-analyzer: true

  # Include query rule-multilingual-analyzer
  include-rule-multilingual-analyzer: true

  # Include query rule-unicode-analyzer
  include-rule-unicode-analyzer: true

  # Include query rule-utf8-analyzer
  include-rule-utf8-analyzer: true

  # Include query rule-ascii-analyzer
  include-rule-ascii-analyzer: true

  # Include query rule-base64-analyzer
  include-rule-base64-analyzer: true

  # Include query rule-hex-analyzer
  include-rule-hex-analyzer: true

  # Include query rule-binary-analyzer
  include-rule-binary-analyzer: true

  # Include query rule-octal-analyzer
  include-rule-octal-analyzer: true

  # Include query rule-decimal-analyzer
  include-rule-decimal-analyzer: true

  # Include query rule-float-analyzer
  include-rule-float-analyzer: true

  # Include query rule-double-analyzer
  include-rule-double-analyzer: true

  # Include query rule-integer-analyzer
  include-rule-integer-analyzer: true

  # Include query rule-long-analyzer
  include-rule-long-analyzer: true

  # Include query rule-short-analyzer
  include-rule-short-analyzer: true

  # Include query rule-byte-analyzer
  include-rule-byte-analyzer: true

  # Include query rule-char-analyzer
  include-rule-char-analyzer: true

  # Include query rule-boolean-analyzer
  include-rule-boolean-analyzer: true

  # Include query rule-null-analyzer
  include-rule-null-analyzer: true

  # Include query rule-undefined-analyzer
  include-rule-undefined-analyzer: true

  # Include query rule-nan-analyzer
  include-rule-nan-analyzer: true

  # Include query rule-infinity-analyzer
  include-rule-infinity-analyzer: true

  # Include query rule-negative-infinity-analyzer
  include-rule-negative-infinity-analyzer: true

  # Include query rule-positive-infinity-analyzer
  include-rule-positive-infinity-analyzer: true

  # Include query rule-zero-analyzer
  include-rule-zero-analyzer: true

  # Include query rule-negative-zero-analyzer
  include-rule-negative-zero-analyzer: true

  # Include query rule-positive-zero-analyzer
  include-rule-positive-zero-analyzer: true

  # Include query rule-one-analyzer
  include-rule-one-analyzer: true

  # Include query rule-negative-one-analyzer
  include-rule-negative-one-analyzer: true

  # Include query rule-positive-one-analyzer
  include-rule-positive-one-analyzer: true

  # Include query rule-two-analyzer
  include-rule-two-analyzer: true

  # Include query rule-negative-two-analyzer
  include-rule-negative-two-analyzer: true

  # Include query rule-positive-two-analyzer
  include-rule-positive-two-analyzer: true

  # Include query rule-three-analyzer
  include-rule-three-analyzer: true

  # Include query rule-negative-three-analyzer
  include-rule-negative-three-analyzer: true

  # Include query rule-positive-three-analyzer
  include-rule-positive-three-analyzer: true

  # Include query rule-four-analyzer
  include-rule-four-analyzer: true

  # Include query rule-negative-four-analyzer
  include-rule-negative-four-analyzer: true

  # Include query rule-positive-four-analyzer
  include-rule-positive-four-analyzer: true

  # Include query rule-five-analyzer
  include-rule-five-analyzer: true

  # Include query rule-negative-five-analyzer
  include-rule-negative-five-analyzer: true

  # Include query rule-positive-five-analyzer
  include-rule-positive-five-analyzer: true

  # Include query rule-six-analyzer
  include-rule-six-analyzer: true

  # Include query rule-negative-six-analyzer
  include-rule-negative-six-analyzer: true

  # Include query rule-positive-six-analyzer
  include-rule-positive-six-analyzer: true

  # Include query rule-seven-analyzer
  include-rule-seven-analyzer: true

  # Include query rule-negative-seven-analyzer
  include-rule-negative-seven-analyzer: true

  # Include query rule-positive-seven-analyzer
  include-rule-positive-seven-analyzer: true

  # Include query rule-eight-analyzer
  include-rule-eight-analyzer: true

  # Include query rule-negative-eight-analyzer
  include-rule-negative-eight-analyzer: true

  # Include query rule-positive-eight-analyzer
  include-rule-positive-eight-analyzer: true

  # Include query rule-nine-analyzer
  include-rule-nine-analyzer: true

  # Include query rule-negative-nine-analyzer
  include-rule-negative-nine-analyzer: true

  # Include query rule-positive-nine-analyzer
  include-rule-positive-nine-analyzer: true

  # Include query rule-ten-analyzer
  include-rule-ten-analyzer: true

  # Include query rule-negative-ten-analyzer
  include-rule-negative-ten-analyzer: true

  # Include query rule-positive-ten-analyzer
  include-rule-positive-ten-analyzer: true
